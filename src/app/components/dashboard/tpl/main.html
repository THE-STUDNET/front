
<div class="columns" id="feed">
    <div class="col_left">
        <div class="box" id="timeline">
            <h1 class="title">
                <span class="i16 i-comingup"></span>
                <span class="txt">TO DO</span>
            </h1>
            <div id="assignments-list" class="items" infinite-scroll="{ cb:ctrl.getNextAssignments,distance:10, container : '#assignments-list', reverse : true }">
                <div loader ng-if="ctrl.assignments_pagination.after.loading"></div>
                <a class="item" ng-click="ctrl.goToAssignment(ctrl.items[assignment.id].datum)"
                     ng-class="{ ended : assignment.state === 'ended' }"
                     ng-if="ctrl.items[assignment.id] && ctrl.submissions[assignment.id] &&
                        (assignment.timeline_type !== 'S' || $index === 0 || assignment.id !== ctrl.assignments[$index - 1].id)"
                     ng-repeat="assignment in ctrl.assignments">

                    <div class="type" >
                        <span class="i12 {{ ctrl.types[ctrl.items[assignment.id].datum.type].icon }}"></span>
                        <span class="type-name" translate>
                            {{ ctrl.types[ctrl.items[assignment.id].datum.type].label }}
                        </span>
                        <div item-status="assignment.id"></div>
                        <span ui-sref="lms.page.content({ id : ctrl.items[assignment.id].datum.page_id, type : 'course', item_id : ctrl.items[assignment.id].datum.id })" class="i16 i-right"></span>

                    </div>
                    <div class="name">
                        {{ ctrl.items[assignment.id].datum.title }}
                     </div>
                    <div class="inf">
                        <div ng-if="assignment.timeline_type === 'S' || ($index < ctrl.assignments.length - 1 && assignment.id === ctrl.assignments[$index + 1].id)"> <span class="start">Start</span> {{ ctrl.items[assignment.id].datum.start_date | dateWithHour }}</div>
                        <div ng-if="assignment.timeline_type === 'E'"> <span class="end">End</span> {{ ctrl.items[assignment.id].datum.end_date | dateWithHour }}</div>

                    </div>

                </a>
                <div loader ng-if="ctrl.assignments_pagination.before.loading"></div>
                <button ng-if="!ctrl.assignments_pagination.before.loading && !ctrl.assignments_pagination.before.ended" class="load-previous i-down" ng-click="ctrl.getPreviousAssignments()">

                </button>
            </div>

        </div>
        <div class="box" ng-if="app.session.roles[1]">
            <h1 class="title">
                <span class="i16 i-diploma"></span>
                <span class="txt">Institution</span>
            </h1>
            <div class="cta green" ng-click="app.openPageModal($event, 'organization')"
               >
               Create an institution
           </div>
        </div>
        <div ng-if="ctrl.courses" page-list="ctrl.courses"
            user-id="app.session.id"
            page-type="course" page-create="ctrl.organizations.length || app.session.roles[1]">

        </div>
        <div ng-if="ctrl.groups" page-list="ctrl.groups"
            user-id="app.session.id"
            page-type="group" page-create="true">

        </div>
        <div ng-if="ctrl.events" page-list="ctrl.events"
            user-id="app.session.id"
            page-type="event" page-create="true">

        </div>

    </div>
    <div class="col_center" infinite-scroll="{cb:ctrl.loadNext,distance:50,container:'window'}">
        <postform class="box" onsent="ctrl.onPostAdded"></postform>
        <div class="posts">
            <button class="reloadbtn" ng-if="ctrl.hasUpdates"
                ng-click="ctrl.refresh()">{{ ctrl.hasUpdates }} update(s) on your feed. Click to refresh</button>
            <div loader ng-if="ctrl.refreshing"></div>
            <div class="box post" ng-repeat="id in ctrl.post_ids track by id" post="id" onremove="ctrl.onPostRemoved"></div>
            <div loader ng-if="ctrl.loadingNext"></div>
        </div>
    </div>
</div>
